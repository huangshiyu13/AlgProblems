# from collections import defaultdict,OrderedDict,Callable

class DrySuite():
    def __init__(self, linked_lakes=None, dry_days=None, next_suite=None):
        self.linked_lakes = linked_lakes
        self.next_suit = next_suite
        self.dry_days = dry_days


class RainDay():
    def __init__(self, rain_lake=None, pre_day=None, next_day=None, drySuit=None):
        self.rain_lake = rain_lake
        self.pre_day = pre_day
        self.next_day = next_day
        self.drySuit = drySuit


class ChainManager():
    def __init__(self):
        pass

    def new_dry_day(self, dry_day):
        pass

    def new_rain_day(self, rain_lake):
        pass

class Solution:
    def avoidFlood(self, rains):
        chainManager = ChainManager()

        ans = [-1 if r > 0 else 1 for r in rains]
        for i in range(len(rains)):
            lake = rains[i]
            if lake == 0:
                chainManager.new_dry_day(i)
            else:
                chainManager.new_rain_day(lake)
        return ans


def check_ans(rains, ans):
    a = []
    for i in range(len(ans)):
        if rains[i] > 0:
            assert ans[i] == -1, 'i={},rain={},ans={}'.format(i, rains[i], ans[i])
            if rains[i] in a:
                print('wrong for i={},rain={}'.format(i, rains[i]))
                for ii, r in enumerate(rains):
                    if r == rains[i]:
                        print(ii, r)
                for ii, l in enumerate(ans):
                    if l == rains[i]:
                        print(ii)
            a.append(rains[i])

        if rains[i] == 0:
            if ans[i] in a:
                a.remove(ans[i])


if __name__ == '__main__':
    import time

    # rains = [1,2,0,0,2,1]
    rains = [1, 2, 0, 0, 2, 1]
    rains = [1, 2, 0, 1, 2]

    # 300
    # 49546
    # 519
    # 49546
    # 229

    rains = [98284, 57875, 0, 0, 94301, 94503, 16548, 0, 0, 37144, 0, 0, 0, 63939, 0, 0, 0, 0, 57020, 47710, 3285,
             71226, 0, 24745, 0, 0, 70243, 0, 51703, 80321, 95971, 22206, 0, 43959, 84602, 77192, 0, 0, 0, 0, 0, 6407,
             6477, 99867, 0, 24520, 0, 0, 0, 0, 9799, 43282, 52055, 96659, 51254, 40585, 79473, 0, 0, 0, 0, 9481, 0, 0,
             0, 35881, 54126, 8792, 0, 0, 0, 22570, 0, 0, 879, 2319, 0, 4889, 46458, 0, 0, 0, 36638, 69875, 57212,
             57875, 0, 0, 96659, 75448, 51766, 6379, 57212, 99867, 86167, 0, 93231, 52568, 16312, 0, 0, 19402, 0, 0,
             8602, 0, 0, 0, 3285, 39361, 36638, 0, 0, 22206, 0, 38549, 94503, 14659, 0, 16548, 0, 0, 54126, 11157,
             70915, 0, 0, 81337, 19893, 54920, 51766, 51244, 17717, 69787, 46075, 0, 42139, 0, 0, 0, 4428, 0, 0, 0, 0,
             0, 9292, 80984, 17717, 54920, 0, 0, 18568, 0, 19946, 0, 69683, 0, 0, 0, 13735, 79530, 42193, 0, 1149,
             78534, 0, 0, 0, 55452, 14864, 24745, 26551, 0, 0, 24233, 0, 79712, 0, 62236, 0, 0, 47800, 0, 6695, 40585,
             0, 52402, 879, 68267, 0, 96631, 64057, 84363, 0, 0, 0, 63335, 96878, 0, 47800, 0, 0, 61952, 0, 0, 24297, 0,
             0, 0, 14584, 0, 42139, 65252, 64136, 11157, 6695, 0, 14877, 0, 0, 0, 44942, 73999, 0, 0, 45572, 0, 86167,
             0, 0, 0, 0, 42193, 0, 84363, 0, 63939, 0, 76503, 0, 51198, 0, 9481, 0, 6407, 0, 64277, 0, 0, 0, 1149, 3072,
             0, 24233, 783, 0, 0, 9036, 39361, 22947, 0, 51703, 0, 0, 52055, 97859, 25989, 0, 0, 0, 0, 77192, 0, 0,
             12234, 57020, 79530, 0, 0, 19946, 0, 0, 0, 0, 61952, 36135, 0, 0, 34886, 0, 97617, 66393, 0, 0, 80321, 0,
             0, 75482, 97859, 49546, 22947, 0, 73999, 0, 0, 68267, 0, 18529, 65252, 2319, 18568, 0, 0, 0, 69939, 508, 0,
             0, 0, 65617, 24520, 82199, 93231, 64015, 0, 39813, 0, 0, 0, 16814, 74810, 0, 0, 55452, 0, 43282, 39813, 0,
             0, 80942, 0, 70915, 4428, 0, 43683, 0, 82199, 90187, 0, 13584, 36135, 0, 74810, 961, 0, 44942, 0, 0, 32578,
             90187, 0, 69683, 0, 38549, 0, 0, 13735, 33424, 0, 59757, 64277, 6477, 0, 0, 94301, 52568, 0, 0, 0, 0, 0, 0,
             0, 63505, 0, 0, 0, 51254, 0, 0, 46458, 64015, 0, 0, 66393, 58429, 0, 64136, 69875, 62236, 0, 0, 0, 0, 4770,
             0, 89776, 0, 961, 34886, 62059, 0, 65617, 0, 0, 81337, 63335, 0, 0, 0, 43683, 0, 45572, 0, 0, 97617, 0,
             9799, 32578, 0, 0, 0, 22570, 95971, 0, 64057, 4770, 0, 46075, 0, 0, 0, 0, 0, 96631, 0, 0, 26551, 0, 8602,
             18529, 0, 0, 0, 0, 0, 60713, 0, 70243, 0, 59757, 75482, 0, 0, 78534, 0, 0, 51198, 16814, 0, 0, 58429, 0, 0,
             9036, 96878, 0, 0, 71226, 51244, 76503, 0, 0, 64319, 0, 24297, 14864, 0, 25989, 12234, 62059, 0, 84602, 0,
             0, 19893, 0, 783, 75448, 69939, 67299, 0, 0, 0, 75087, 0, 0, 37144, 33424, 0, 0, 67299, 0, 0, 20507, 0, 0,
             69787, 49546, 14877, 9292, 0, 0, 14659, 89776, 0, 0, 0, 0, 75087, 35881, 3072, 19402, 14584, 0, 0, 13584,
             508, 0, 80942, 0, 6379, 0, 0, 60713, 0, 0, 4889, 4528, 0, 0, 0, 0, 0, 0, 8792, 0, 79712, 0, 0, 0, 16312, 0,
             47710, 64319, 98284, 0, 4528, 80984, 43959, 79473, 63505, 52402, 20507, 0]
    rains = [1, 2, 0, 2, 3, 0, 1]
    rains = [0, 11475, 23148, 0, 91836, 0, 0, 0, 0, 18987, 0, 3057, 0, 0, 0, 69217, 0, 0, 65289, 0, 0, 0, 35467, 33617,
             0, 0, 0,
             0, 55602, 67935, 0, 0, 2530, 84750, 0, 0, 4411, 0, 0, 81775, 0, 46174, 33617, 0, 60322, 60801, 56836,
             72787, 4022,
             91465, 21256, 0, 0, 0, 0, 0, 2530, 0, 14817, 57045, 0, 0, 0, 2583, 62414, 4452, 28481, 54082, 36928, 25662,
             14817,
             95392, 22974, 1040, 0, 93616, 0, 0, 59731, 0, 61094, 0, 65368, 82028, 22053, 54082, 0, 0, 4452, 81775,
             98696, 0, 0,
             5717, 91465, 0, 0, 20971, 0, 0, 0, 0, 0, 0, 0, 8644, 82028, 55602, 0, 77965, 0, 59578, 0, 0, 0, 42529, 0,
             0, 0, 0,
             0, 36928, 0, 20971, 25671, 0, 0, 0, 59289, 0, 0, 0, 0, 0, 0, 59289, 72266, 0, 0, 0, 92138, 77364, 59578,
             46174, 0,
             2583, 60322, 0, 0, 0, 0, 0, 0, 72787, 4022, 0, 95082, 0, 0, 0, 0, 22974, 22053, 60801, 0, 67634, 27785, 0,
             91836,
             95392, 0, 77364, 28481, 4411, 0, 91988, 0, 0, 0, 27785, 69763, 0, 77965, 7509, 67935, 0, 62414, 18987,
             84750, 0, 0,
             9118, 0, 9118, 64611, 0, 0, 59731, 0, 0, 69217, 0, 65368, 0, 0, 90771, 0, 0, 56836, 8644, 0, 25662, 1040,
             7509,
             90771, 0, 0, 5717, 0, 0, 0, 93616, 0, 0, 92138, 91988, 0, 0, 61094, 57045, 0, 0, 0, 95082, 0, 23148, 0,
             98696,
             25671, 11475, 0, 35467, 21256, 65289, 68210, 69763, 0, 0, 72266, 3057, 67634, 64611, 42529, 68210]
    rains = [98284, 57875, 0, 0, 94301, 94503, 16548, 0, 0, 37144, 0, 0, 0, 63939, 0, 0, 0, 0, 57020, 47710, 3285,
             71226, 0, 24745, 0, 0, 70243, 0, 51703, 80321, 95971, 22206, 0, 43959, 84602, 77192, 0, 0, 0, 0, 0, 6407,
             6477, 99867, 0, 24520, 0, 0, 0, 0, 9799, 43282, 52055, 96659, 51254, 40585, 79473, 0, 0, 0, 0, 9481, 0, 0,
             0, 35881, 54126, 8792, 0, 0, 0, 22570, 0, 0, 879, 2319, 0, 4889, 46458, 0, 0, 0, 36638, 69875, 57212,
             57875, 0, 0, 96659, 75448, 51766, 6379, 57212, 99867, 86167, 0, 93231, 52568, 16312, 0, 0, 19402, 0, 0,
             8602, 0, 0, 0, 3285, 39361, 36638, 0, 0, 22206, 0, 38549, 94503, 14659, 0, 16548, 0, 0, 54126, 11157,
             70915, 0, 0, 81337, 19893, 54920, 51766, 51244, 17717, 69787, 46075, 0, 42139, 0, 0, 0, 4428, 0, 0, 0, 0,
             0, 9292, 80984, 17717, 54920, 0, 0, 18568, 0, 19946, 0, 69683, 0, 0, 0, 13735, 79530, 42193, 0, 1149,
             78534, 0, 0, 0, 55452, 14864, 24745, 26551, 0, 0, 24233, 0, 79712, 0, 62236, 0, 0, 47800, 0, 6695, 40585,
             0, 52402, 879, 68267, 0, 96631, 64057, 84363, 0, 0, 0, 63335, 96878, 0, 47800, 0, 0, 61952, 0, 0, 24297, 0,
             0, 0, 14584, 0, 42139, 65252, 64136, 11157, 6695, 0, 14877, 0, 0, 0, 44942, 73999, 0, 0, 45572, 0, 86167,
             0, 0, 0, 0, 42193, 0, 84363, 0, 63939, 0, 76503, 0, 51198, 0, 9481, 0, 6407, 0, 64277, 0, 0, 0, 1149, 3072,
             0, 24233, 783, 0, 0, 9036, 39361, 22947, 0, 51703, 0, 0, 52055, 97859, 25989, 0, 0, 0, 0, 77192, 0, 0,
             12234, 57020, 79530, 0, 0, 19946, 0, 0, 0, 0, 61952, 36135, 0, 0, 34886, 0, 97617, 66393, 0, 0, 80321, 0,
             0, 75482, 97859, 49546, 22947, 0, 73999, 0, 0, 68267, 0, 18529, 65252, 2319, 18568, 0, 0, 0, 69939, 508, 0,
             0, 0, 65617, 24520, 82199, 93231, 64015, 0, 39813, 0, 0, 0, 16814, 74810, 0, 0, 55452, 0, 43282, 39813, 0,
             0, 80942, 0, 70915, 4428, 0, 43683, 0, 82199, 90187, 0, 13584, 36135, 0, 74810, 961, 0, 44942, 0, 0, 32578,
             90187, 0, 69683, 0, 38549, 0, 0, 13735, 33424, 0, 59757, 64277, 6477, 0, 0, 94301, 52568, 0, 0, 0, 0, 0, 0,
             0, 63505, 0, 0, 0, 51254, 0, 0, 46458, 64015, 0, 0, 66393, 58429, 0, 64136, 69875, 62236, 0, 0, 0, 0, 4770,
             0, 89776, 0, 961, 34886, 62059, 0, 65617, 0, 0, 81337, 63335, 0, 0, 0, 43683, 0, 45572, 0, 0, 97617, 0,
             9799, 32578, 0, 0, 0, 22570, 95971, 0, 64057, 4770, 0, 46075, 0, 0, 0, 0, 0, 96631, 0, 0, 26551, 0, 8602,
             18529, 0, 0, 0, 0, 0, 60713, 0, 70243, 0, 59757, 75482, 0, 0, 78534, 0, 0, 51198, 16814, 0, 0, 58429, 0, 0,
             9036, 96878, 0, 0, 71226, 51244, 76503, 0, 0, 64319, 0, 24297, 14864, 0, 25989, 12234, 62059, 0, 84602, 0,
             0, 19893, 0, 783, 75448, 69939, 67299, 0, 0, 0, 75087, 0, 0, 37144, 33424, 0, 0, 67299, 0, 0, 20507, 0, 0,
             69787, 49546, 14877, 9292, 0, 0, 14659, 89776, 0, 0, 0, 0, 75087, 35881, 3072, 19402, 14584, 0, 0, 13584,
             508, 0, 80942, 0, 6379, 0, 0, 60713, 0, 0, 4889, 4528, 0, 0, 0, 0, 0, 0, 8792, 0, 79712, 0, 0, 0, 16312, 0,
             47710, 64319, 98284, 0, 4528, 80984, 43959, 79473, 63505, 52402, 20507, 0]
    rains = list(range(1, 25001)) + [0] * 50000 + list(range(1, 25001))
    rains = [0, 11475, 23148, 0, 91836, 0, 0, 0, 0, 18987, 0, 3057, 0, 0, 0, 69217, 0, 0, 65289, 0, 0, 0, 35467, 33617,
             0, 0, 0, 0, 55602, 67935, 0, 0, 2530, 84750, 0, 0, 4411, 0, 0, 81775, 0, 46174, 33617, 0, 60322, 60801,
             56836, 72787, 4022, 91465, 21256, 0, 0, 0, 0, 0, 2530, 0, 14817, 57045, 0, 0, 0, 2583, 62414, 4452, 28481,
             54082, 36928, 25662, 14817, 95392, 22974, 1040, 0, 93616, 0, 0, 59731, 0, 61094, 0, 65368, 82028, 22053,
             54082, 0, 0, 4452, 81775, 98696, 0, 0, 5717, 91465, 0, 0, 20971, 0, 0, 0, 0, 0, 0, 0, 8644, 82028, 55602,
             0, 77965, 0, 59578, 0, 0, 0, 42529, 0, 0, 0, 0, 0, 36928, 0, 20971, 25671, 0, 0, 0, 59289, 0, 0, 0, 0, 0,
             0, 59289, 72266, 0, 0, 0, 92138, 77364, 59578, 46174, 0, 2583, 60322, 0, 0, 0, 0, 0, 0, 72787, 4022, 0,
             95082, 0, 0, 0, 0, 22974, 22053, 60801, 0, 67634, 27785, 0, 91836, 95392, 0, 77364, 28481, 4411, 0, 91988,
             0, 0, 0, 27785, 69763, 0, 77965, 7509, 67935, 0, 62414, 18987, 84750, 0, 0, 9118, 0, 9118, 64611, 0, 0,
             59731, 0, 0, 69217, 0, 65368, 0, 0, 90771, 0, 0, 56836, 8644, 0, 25662, 1040, 7509, 90771, 0, 0, 5717, 0,
             0, 0, 93616, 0, 0, 92138, 91988, 0, 0, 61094, 57045, 0, 0, 0, 95082, 0, 23148, 0, 98696, 25671, 11475, 0,
             35467, 21256, 65289, 68210, 69763, 0, 0, 72266, 3057, 67634, 64611, 42529, 68210]
    solution = Solution()
    t = time.time()
    ans = solution.avoidFlood(rains)
    print(time.time() - t)
    # res = "\n".join("{} {}".format(x, y) for x, y in zip(rains, ans))
    print(ans)
    check_ans(rains, ans)
